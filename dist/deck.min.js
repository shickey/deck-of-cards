"use strict";var Deck=function(){function n(n,e){var r=Date.now(),o=r+n,i=o+e,u={start:o,end:i};b.push(u),k||(k=!0,requestAnimationFrame(t));var a={start:function(n){return u.startcb=n,a},progress:function(n){return u.progresscb=n,a},end:function(n){return u.endcb=n,a}};return a}function t(){var n=Date.now();if(!b.length)return void(k=!1);for(var e,r=0;r<b.length;r++)if(e=b[r],!(n<e.start)){e.started||(e.started=!0,e.startcb&&e.startcb());var o=(n-e.start)/(e.end-e.start);e.progresscb&&e.progresscb(o<1?o:1),n>e.end&&(e.endcb&&e.endcb(),b.splice(r--,1))}requestAnimationFrame(t)}function e(n){return(Math.round(Math.random())?-1:1)*n}function r(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}function o(n){for(var t,e,r=n.length-1;r;r--)t=Math.floor(Math.random()*(r+1)),e=n[r],n[r]=n[t],n[t]=e;return n}function i(n){if(void 0!==F[n])return F[n];if(void 0!==z[n])return F[n]=n,n;for(var t,e=n[0].toUpperCase()+n.slice(1),r=["webkit","moz","Moz","ms","o"],o=0,i=r.length;o<i;o++)if(t=r[o]+e,void 0!==z[t])return F[n]=t,t}function u(n,t,e){return void 0!==S||(S=a()),e=e||0,S?"translate3d("+n+", "+t+", "+e+")":"translate("+n+", "+t+")"}function a(){if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return!1;var n=i("transform"),t=document.createElement("p");return document.body.appendChild(t),t.style[n]="translate3d(1px,1px,1px)",S=t.style[n],S=null!=S&&S.length&&"none"!==S,document.body.removeChild(t),S}function c(n){return n*Math.PI/180}function d(n){return document.createElement(n)}function f(t){function e(n){n.appendChild(p),g.$root=n}function r(){g.$root&&g.$root.removeChild(p),g.$root=null}function o(n){n===f.Side.FRONT?(g.side===f.Side.BACK&&p.removeChild(m),g.side=f.Side.FRONT,p.appendChild(y),g.setRankSuit(g.rank,g.suit)):(g.side===f.Side.FRONT&&p.removeChild(y),g.side=f.Side.BACK,p.appendChild(m),p.setAttribute("class","card"))}var a,c=i("transform"),l=t%13+1,h=t/13|0,v=(52-t)/4,p=d("div"),y=d("div"),m=d("div"),g={i:t,rank:l,suit:h,pos:t,$el:p,mount:e,unmount:r,setSide:o},k=x.modules;y.classList.add("face"),m.classList.add("back"),p.style[c]=u(-v+"px",-v+"px"),g.x=-v,g.y=-v,g.z=v,g.rot=0,g.setSide(f.Side.BACK);for(a in k)!function(n){n.card&&n.card(g)}(k[a]);return g.animateTo=function(t){var e=t.delay,r=t.duration,o=t.x,i=void 0===o?g.x:o,a=t.y,d=void 0===a?g.y:a,f=t.rot,s=void 0===f?g.rot:f,l=t.ease,h=t.onStart,v=t.onProgress,y=t.onComplete;e=e||0,r=r||500;var m,x,k,b,C,q;n(e,r).start(function(){m=g.x||0,x=g.y||0,k=g.rot||0,h&&h()}).progress(function(n){var t=T[l||"cubicInOut"](n);b=i-m,C=d-x,q=s-k,v&&v(n,t),g.x=m+b*t,g.y=x+C*t,g.rot=k+q*t,p.style[c]=u(g.x+"px",g.y+"px")+(g.rot?"rotate("+g.rot+"deg)":"")}).end(function(){y&&y()})},g.setRankSuit=function(n,t){var e=s(t);p.setAttribute("class","card "+e+" rank"+n)},g.setRankSuit(l,h),g}function s(n){return 0===n?"spades":1===n?"hearts":2===n?"clubs":3===n?"diamonds":"joker"}function l(){return 3.875*r()}function h(){return 5.5*r()}function v(n,t,e){function r(n){return function(){var t=c.cards.pop();t.$el.classList.remove("glow"),t.$el.onclick=null,c.canDraw=!1,n&&n(t)}}var o=e.x,i=e.y,u=e.rot,a=e.side;o=o||0,i=i||0,u=u||0,a=a||f.Side.BACK;var c=Object.assign(m(n,t),{x:o,y:i,rot:u,side:a,canDraw:!1});return t.forEach(function(n){n.$el.onclick=null}),c.layout=function(){if(0!==c.cards.length){var n=c.cards.slice();c.queued(function(t){n.forEach(function(e,r){var o=r/4;e.setSide(c.side),e.$el.style.zIndex=r,e.animateTo({delay:0,duration:200,x:c.x-o,y:c.y-o,rot:c.rot,onComplete:function(){r===n.length-1&&t()}})})})()}},c.draw=function(n){if(void 0===n&&(n=1),1==n)return c.cards.pop();for(var t=[],e=0;e<n;++e)t.push(c.cards.pop());return t},c.prepareForDraw=function(n){return 0!=c.cards.length&&(c.queued(function(t){if(n){c.canDraw=!0;var e=c.cards[c.cards.length-1];e.$el.classList.add("glow"),e.$el.onclick=r(n)}else{c.canDraw=!1;var e=c.cards[c.cards.length-1];e.$el.classList.remove("glow"),e.$el.onclick=null}t()})(),!0)},c.layout(),c}function p(n,t,e){var r=e.x,o=e.y,i=e.rot;r=r||0,o=o||0,i=i||0;var u=Object.assign(m(n,t),{x:r,y:o,rot:i});return u.cards.forEach(function(n){n.$el.onclick=null}),u.layout=function(){if(0!==u.cards.length){var n=u.cards.slice(),t=B.getCardWidth(),e=t/10;u.queued(function(r){var o=t*(n.length-1)+e*(n.length-1),i=-o/2;n.forEach(function(o,a){var c=i+(t+e)*a,d=u.rot*Math.PI/180,f=c*Math.cos(d),s=c*Math.sin(d);o.animateTo({duration:200,x:u.x+f,y:u.y+s,rot:u.rot,onComplete:function(){a===n.length-1&&r()}})})})()}},u.peek=function(n,t){var e=0,r=u.cards.slice();u.queued(function(o){r.forEach(function(o){o.$el.classList.add("glow");var i=function i(){e++,e<n?(o.setSide(f.Side.FRONT),o.$el.onclick=null,o.$el.classList.remove("glow")):e==n?(o.setSide(f.Side.FRONT),r.forEach(function(n){n.$el.onclick=i,n.$el.classList.remove("glow"),setTimeout(function(){n.$el.classList.add("glow")},0)})):r.forEach(function(n){n.setSide(f.Side.BACK),n.$el.onclick=null,t&&t()})};o.$el.onclick=i}),o()})()},u.layout(),u}function y(n){function t(n,t,e){i[n]||(i[n]=[]),i[n].push({cb:t,ctx:e})}function e(n,t,e){i[n]||(i[n]=[]),i[n].push({cb:t,ctx:e,once:!0})}function r(n){var t=this,e=Array.prototype.slice(arguments,1);(i[n]||[]).filter(function(n){return n.cb.apply(t,e),!n.once})}function o(n,t){return n?t?void(i[n]=i[n].filter(function(n){return n.cb!==t})):void(i[n]=[]):void(i={})}n||(n={});var i={};return n.on=t,n.one=e,n.off=o,n.trigger=r,n}function m(n,t,e){var r=e&&e.id||n.generateNextCliqueId(),o=y({id:r,deck:n,cards:t,queued:n.queued}),i=x.modules;for(var u in i)!function(n){n.deck&&n.deck(o)}(i[u]);return o.serialize=function(){return{id:o.id,cardIds:o.cards.map(function(n){return n.i})}},o.gatherCards=function(n){var t=[];n.forEach(function(n){t.push(o.deck.cards.find(function(t){return n==t.i}))}),o.cards=t,"function"==typeof o.layout&&o.layout()},o.addCard=function(n){o.cards.push(n),"function"==typeof o.layout&&o.layout()},n.cliques[o.id]=o,o}function g(n){function t(n){return function(){var t=this,r=arguments;e(function(e){n.apply(t,o.concat.apply(e,r))})}}function e(n){n&&(i.push(n),1===i.length&&r())}function r(){i[0](function(n){if(n)throw n;i=i.slice(1),i.length&&r()})}var o=Array.prototype,i=[];return n.queue=e,n.queued=t,n}function x(n){function t(){return(1679973079*m++%Math.pow(36,6)).toString(36)}function e(n){i=n,i.appendChild(s)}function r(){i.removeChild(s)}function o(){var n={};for(var t in l.cliques)n[t]=l.cliques[t].serialize();return n}var i,u,a=new Array(n?55:52),c={},s=d("div"),l=y({mount:e,unmount:r,cards:a,cliques:c,$el:s,serialize:o,generateNextCliqueId:t}),h=x.modules;g(l);for(u in h)!function(n){n.deck&&n.deck(l)}(h[u]);s.classList.add("deck");for(var v,p=a.length;p;p--)v=a[p-1]=f(p-1),v.setSide("back"),v.mount(s);var m=1;return l}var k,b=[];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){setTimeout(n,0)});var C,q,S,$,w,T={linear:function(n){return n},quadIn:function(n){return n*n},quadOut:function(n){return n*(2-n)},quadInOut:function(n){return n<.5?2*n*n:(4-2*n)*n-1},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},quartIn:function(n){return n*n*n*n},quartOut:function(n){return 1- --n*n*n*n},quartInOut:function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},quintIn:function(n){return n*n*n*n*n},quintOut:function(n){return 1+--n*n*n*n*n},quintInOut:function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n}},I={deck:function(n){function t(t,e){var r=n.cards.filter(function(n){return"front"===n.side}).length/n.cards.length;n.cards.forEach(function(n,t){n.setSide(e||(r>.5?"back":"front"))}),t()}n.flip=n.queued(t)}},E={deck:function(n){function t(t,e){var r=n.cards;r.sort(function(n,t){return e?n.i-t.i:t.i-n.i}),r.forEach(function(n,o){n.sort(o,r.length,function(n){n===r.length-1&&t()},e)})}n.sort=n.queued(t)},card:function(n){var t=n.$el;n.sort=function(e,r,o,i){var u=e/4,a=10*e;n.animateTo({delay:a,duration:400,x:-u,y:-150,rot:0,onComplete:function(){t.style.zIndex=e}}),n.animateTo({delay:a+500,duration:400,x:-u,y:-u,rot:0,onComplete:function(){o(e)}})}}},M={deck:function(n){function t(t){var e=n.cards,r=t.order,o=Array(e.length);r.forEach(function(n,t){o[t]=e.find(function(t){return t.i==n})}),n.cards=o.slice(),n.queued(function(n){o.forEach(function(t,e){t.pos=e,t.shuffleTo(function(t){t===o.length-1&&n()})})})()}n.shuffleTo=t},card:function(n){var t=n.$el,o=r();n.shuffleTo=function(r){var i=n.pos,u=i/4,a=2*i;n.animateTo({delay:a,duration:200,x:e(40*Math.random()+20)*o/16,y:-u,rot:0}),n.animateTo({delay:200+a,duration:200,x:-u,y:-u,rot:0,onStart:function(){t.style.zIndex=i},onComplete:function(){r(i)}})}}},O={deck:function(n){function t(t){var e=n.cards;C=r(),o(e),e.forEach(function(n,r){n.pos=r,n.shuffle(function(n){n===e.length-1&&t()})})}n.shuffle=n.queued(t)},card:function(n){var t=n.$el;n.shuffle=function(r){var o=n.pos,i=o/4,u=2*o;n.animateTo({delay:u,duration:200,x:e(40*Math.random()+20)*C/16,y:-i,rot:0}),n.animateTo({delay:200+u,duration:200,x:-i,y:-i,rot:0,onStart:function(){t.style.zIndex=o},onComplete:function(){r(o)}})}}},A={deck:function(n){function t(t){var e=n.cards,o=e.length;q=r(),e.slice(-5).reverse().forEach(function(n,e){n.poker(e,o,function(e){n.setSide("front"),4===e&&t()})})}n.poker=n.queued(t)},card:function(n){var t=n.$el;n.poker=function(e,r,o){var i=250*e;n.animateTo({delay:i,duration:250,x:Math.round(70*(e-2.05)*q/16),y:Math.round(-110*q/16),rot:0,onStart:function(){t.style.zIndex=r-1+e},onComplete:function(){o(e)}})}}},z=document.createElement("p").style,F={},L={deck:function(t){function e(e){var r=t.cards;r.forEach(function(t,o){t.setSide("back"),t.intro(o,function(o){n(250,0).start(function(){t.setSide("back")}),o===r.length-1&&e()})})}t.intro=t.queued(e)},card:function(n){var t=i("transform"),e=n.$el;n.intro=function(r,o){var i=500+10*r,a=r/4;e.style[t]=u(-a+"px","-250px"),e.style.opacity=0,n.x=-a,n.y=-250-a,n.rot=0,n.animateTo({delay:i,duration:1e3,x:-a,y:-a,onStart:function(){e.style.zIndex=r},onProgress:function(n){e.style.opacity=n},onComplete:function(){e.style.opacity="",o&&o(r)}})}}},P={deck:function(n){function t(t){var e=n.cards,o=e.length;$=r(),e.forEach(function(n,r){n.fan(r,o,function(n){n===e.length-1&&t()})})}n.fan=n.queued(t)},card:function(n){var t=n.$el;n.fan=function(e,r,o){var i=e/4,u=10*e,a=e/(r-1)*260-130;n.animateTo({delay:u,duration:300,x:-i,y:-i,rot:0}),n.animateTo({delay:300+u,duration:300,x:55*Math.cos(c(a-90))*$/16,y:55*Math.sin(c(a-90))*$/16,rot:a,onStart:function(){t.style.zIndex=e},onComplete:function(){o(e)}})}}},R={deck:function(n){function t(t){var e=n.cards;w=r(),e.forEach(function(n){n.bysuit(function(n){n===e.length-1&&t()})})}n.bysuit=n.queued(t)},card:function(n){var t=n.rank,e=n.suit;n.bysuit=function(r){var o=n.i,i=10*o;n.animateTo({delay:i,duration:400,x:-Math.round(8*(6.75-t)*w/16),y:-Math.round(92*(1.5-e)*w/16),rot:0,onComplete:function(){r(o)}})}}};f.Side=Object.freeze({FRONT:"front",BACK:"back"});var B={fisherYates:o,getCardWidth:l,getCardHeight:h};return m.Pile=v,m.Hand=p,x.animationFrames=n,x.ease=T,x.modules={bysuit:R,fan:P,intro:L,poker:A,shuffle:O,shuffleTo:M,sort:E,flip:I},x.Card=f,x.prefix=i,x.translate=u,x.Util=B,x.Clique=m,x}();