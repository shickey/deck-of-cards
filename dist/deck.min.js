"use strict";var Deck=function(){function n(n){return document.createElement(n)}function e(n,e){var o=Date.now(),r=o+n,i=r+e,a={start:r,end:i};$.push(a),C||(C=!0,requestAnimationFrame(t));var c={start:function(n){return a.startcb=n,c},progress:function(n){return a.progresscb=n,c},end:function(n){return a.endcb=n,c}};return c}function t(){var n=Date.now();if(!$.length)return void(C=!1);for(var e,o=0;o<$.length;o++)if(e=$[o],!(n<e.start)){e.started||(e.started=!0,e.startcb&&e.startcb());var r=(n-e.start)/(e.end-e.start);e.progresscb&&e.progresscb(r<1?r:1),n>e.end&&(e.endcb&&e.endcb(),$.splice(o--,1))}requestAnimationFrame(t)}function o(n){for(var e,t,o=n.length-1;o;o--)e=Math.floor(Math.random()*(o+1)),t=n[o],n[o]=n[e],n[e]=t;return n}function r(n){return window.getComputedStyle(n.$root).getPropertyValue("font-size").slice(0,-2)}function i(n){return 3.875*r(n)}function a(n){return 5.5*r(n)}function c(n){return n*Math.PI/180}function u(n){if(void 0!==L[n])return L[n];if(void 0!==M[n])return L[n]=n,n;for(var e,t=n[0].toUpperCase()+n.slice(1),o=["webkit","moz","Moz","ms","o"],r=0,i=o.length;r<i;r++)if(e=o[r]+t,void 0!==M[e])return L[n]=e,e}function d(n,e,t){return void 0!==k||(k=s()),t=t||0,k?"translate3d("+n+", "+e+", "+t+")":"translate("+n+", "+e+")"}function s(){if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return!1;var n=u("transform"),e=document.createElement("p");return document.body.appendChild(e),e.style[n]="translate3d(1px,1px,1px)",k=e.style[n],k=null!=k&&k.length&&"none"!==k,document.body.removeChild(e),k}function l(n){return(Math.round(Math.random())?-1:1)*n}function f(n){function e(n,e,t){i[n]||(i[n]=[]),i[n].push({cb:e,ctx:t})}function t(n,e,t){i[n]||(i[n]=[]),i[n].push({cb:e,ctx:t,once:!0})}function o(n){var e=this,t=Array.prototype.slice(arguments,1);(i[n]||[]).filter(function(n){return n.cb.apply(e,t),!n.once})}function r(n,e){return n?e?void(i[n]=i[n].filter(function(n){return n.cb!==e})):void(i[n]=[]):void(i={})}n||(n={});var i={};return n.on=e,n.one=t,n.off=r,n.trigger=o,n}function p(n){function e(n,e){return function(){var o=this,r=arguments;t(function(e){n.apply(o,c.concat.apply(e,r))},e)}}function t(n,e){n&&(d?s.push({action:n,description:e}):(u.push({action:n,description:e}),1===u.length&&o()))}function o(){u[0].action(function(n){if(n)throw n;u=u.slice(1),u.length&&o()})}function r(){if(d)return void console.log("WARNING: Tried to begin a queue transaction while another was open. Ignoring.");s=[],d=!0}function i(){if(!d)return void console.log("WARNING: Tried to close a queue transaction without opening it first.");if(d=!1,0!==s.length){var n=s,e="Transaction:\n"+n.map(function(n){return"\t\t"+n.description}).join("\n");t(function(e){var t=n.length;n.forEach(function(n){n.action(function(){0===--t&&e()})})},e)}}function a(n){r(),n(),i()}var c=Array.prototype,u=[],d=!1,s=[];return n.queue=t,n.queued=e,n.beginQueueTransaction=r,n.endQueueTransaction=i,n.withQueueTransaction=a,n}function h(t){function o(n){n.appendChild(p),g.$root=n}function r(){g.$root&&g.$root.removeChild(p),g.$root=null}function i(n){n===h.Side.FRONT?(g.side===h.Side.BACK&&p.removeChild(m),g.side=h.Side.FRONT,p.appendChild(y),g.setRankSuit(g.rank,g.suit)):(g.side===h.Side.FRONT&&p.removeChild(y),g.side=h.Side.BACK,p.appendChild(m),p.classList.remove("rank"+g.rank),p.classList.remove(v(g.suit)))}var a,c=u("transform"),s=t%13+1,l=t/13|0,f=(52-t)/4,p=n("div"),y=n("div"),m=n("div"),g={i:t,rank:s,suit:l,side:h.Side.BACK,pos:t,$el:p,mount:o,unmount:r,setSide:i},C=x.modules;p.classList.add("card"),y.classList.add("face"),m.classList.add("back"),p.style[c]=d(-f+"px",-f+"px"),g.x=-f,g.y=-f,g.z=f,g.rot=0,g.setSide(h.Side.BACK);for(a in C)!function(n){n.card&&n.card(g)}(C[a]);return g.animateTo=function(n){var t=n.delay,o=n.duration,r=n.x,i=void 0===r?g.x:r,a=n.y,u=void 0===a?g.y:a,s=n.rot,l=void 0===s?g.rot:s,f=n.ease,h=n.onStart,v=n.onProgress,y=n.onComplete;t=t||0,o=o||500;var m,x,C,$,b,S;e(t,o).start(function(){m=g.x||0,x=g.y||0,C=g.rot||0,h&&h()}).progress(function(n){var e=E[f||"cubicInOut"](n);$=i-m,b=u-x,S=l-C,v&&v(n,e),g.x=m+$*e,g.y=x+b*e,g.rot=C+S*e,p.style[c]=d(g.x+"px",g.y+"px")+(g.rot?"rotate("+g.rot+"deg)":"")}).end(function(){y&&y()})},g.setGlow=function(n){n?g.$el.classList.add("glow"):g.$el.classList.remove("glow")},g.setRankSuit=function(n,e){var t=v(e);p.classList.add(t,"rank"+n)},g.setRankSuit(s,l),g}function v(n){return 0===n?"spades":1===n?"hearts":2===n?"clubs":3===n?"diamonds":"joker"}function y(t,o,r){function i(n){var e={};e=0===f.cards.length?p:f.cards[f.cards.length-1],n?(e.setGlow(!0),e.$el.onclick=function(){"function"==typeof f.onSelect&&f.onSelect()}):(e.setGlow(!1),e.$el.onclick=null)}var a=r.x,c=r.y,s=r.rot,l=r.side;a=a||0,c=c||0,s=s||0,l=l||h.Side.BACK;var f=Object.assign(g(t,o),{x:a,y:c,rot:s,side:l,$root:t.$root,selectionEnabled:!1});o.forEach(function(n){n.$el.onclick=null});var p={$el:n("div")},v=p.$el,y=u("transform");v.classList.add("pile-outline"),v.style[y]=d(f.x+"px",f.y+"px"),v.style.zIndex=-1,p.setGlow=function(n){n?this.$el.classList.add("glow"):this.$el.classList.remove("glow")},f.$root.appendChild(v);var m={$el:n("div")},x=m.$el,y=u("transform");x.classList.add("helper"),x.style[y]=d(f.x+"px",f.y+"px"),x.style.zIndex=100;var C=!1;return f.showHelper=function(n,t){var o=t&&t.animationDuration||(n?500:250);n?(t&&t.content&&(m.$el.textContent="",m.$el.appendChild(t.content)),C||f.queued(function(n){var t=T.getCardWidth(f.deck),r=t/10,i=f.cards.length/4,a=f.x+t/2+r+t/8-i+8*T.getFontSize(f.deck);m.$el.style[y]=d(a+"px",f.y-i+"px"),m.$el.style.opacity=0,f.$root.appendChild(m.$el),e(0,o).progress(function(n){var e=E.cubicInOut(n);m.$el.style.opacity=e}).end(function(){n()})},"PILE ("+f.id+") show helper")(),C=!0):(C&&function(){var n=function(n){n.stopPropagation()};m.$el.addEventListener("click",n,!0),f.queued(function(t){e(0,o).progress(function(n){var e=E.cubicInOut(n);m.$el.style.opacity=1-e}).end(function(){m.$el.removeEventListener("click",n,!0),f.$root.removeChild(m.$el),t()})},"PILE ("+f.id+") hide helper")()}(),C=!1)},f.layout=function(n,e){if(0!==f.cards.length||C){var t=f.cards.slice(),o=T.getCardWidth(f.deck),r=o/10;f.queued(function(n){if(t.length>0){if(t.forEach(function(o,r){var i=r/4;o.setSide(f.side),o.$el.style.zIndex=r,o.animateTo({delay:e&&e.delay||0,duration:e&&e.duration||500,x:f.x-i,y:f.y-i,rot:f.rot,onComplete:function(){r===t.length-1&&n()}})}),C){var i=t.length/4,a=f.x+o/2+r+o/8-i+8*T.getFontSize(f.deck);m.$el.style[y]=d(a+"px",f.y-i+"px")}}else C&&(m.$el.style[y]=d(f.x+"px",f.y+"px")),n()},"HAND ("+f.id+") layout "+(n?": "+n:""))()}},f.popCard=function(n){if(f.selectionEnabled&&i(!1),void 0===n&&(n=1),1==n)return f.cards.pop();if(n<=0)return[];for(var e=[],t=0;t<n;++t)e.push(f.cards.pop());return f.selectionEnabled&&f.cards.length>0&&i(!0),e},f.pushCard=function(n){f.selectionEnabled&&i(!1),f.cards.push(n),f.selectionEnabled&&i(!0)},f.removeAllCards=function(){f.enableSelection(!1),f.cards=[]},f.enableSelection=function(n){f.queued(function(e){f.selectionEnabled=n,i(n),e()},"PILE ("+f.id+") enable selection ("+n+")")()},f.layout(),f}function m(t,o,r){var i=r.x,a=r.y,c=r.rot,s=r.side;i=i||0,a=a||0,c=c||0,s=s||h.Side.BACK;var l=new Set,f=Object.assign(g(t,o),{x:i,y:a,rot:c,side:s,prominentCards:l,$root:t.$root});f.cards.forEach(function(n){n.$el.onclick=null});var p={$el:n("div")},v=p.$el,y=u("transform");v.classList.add("helper"),v.style[y]=d(f.x+"px",f.y+"px"),v.style.zIndex=100;var m=!1;return f.showHelper=function(n,t){var o=t&&t.animationDuration||(n?500:250);n?(t&&t.content&&(p.$el.textContent="",p.$el.appendChild(t.content)),m||f.queued(function(n){if(f.cards.length>0){var t=T.getCardWidth(f.deck),r=t/10,i=t*(f.cards.length-1)+r*(f.cards.length-1),a=-i/2,c=a+(t+r)*f.cards.length-3*t/8+8*T.getFontSize(f.deck),u=f.rot*Math.PI/180,s=c*Math.cos(u),l=c*Math.sin(u);p.$el.classList.remove("alone"),p.$el.style[y]=d(f.x+s+"px",f.y+l+"px")+(f.rot?"rotate("+f.rot+"deg)":"")}else p.$el.classList.add("alone"),p.$el.style[y]=d(f.x+"px",f.y+"px")+(f.rot?"rotate("+f.rot+"deg)":"");p.$el.style.opacity=0,f.$root.appendChild(p.$el),e(0,o).progress(function(n){var e=E.cubicInOut(n);p.$el.style.opacity=e}).end(function(){n()})},"HAND ("+f.id+") show helper")(),m=!0):(m&&function(){var n=function(n){n.stopPropagation()};p.$el.addEventListener("click",n,!0),f.queued(function(t){e(0,o).progress(function(n){var e=E.cubicInOut(n);p.$el.style.opacity=1-e}).end(function(){p.$el.removeEventListener("click",n,!0),f.$root.removeChild(p.$el),t()})},"HAND ("+f.id+") hide helper")()}(),m=!1)},f.layout=function(n,e){if(0!==f.cards.length||m){var t=f.cards.slice(),o=T.getCardWidth(f.deck),r=T.getCardHeight(f.deck),i=o/10;f.queued(function(n){if(t.length>0){var a=o*(t.length-1)+i*(t.length-1),c=-a/2;if(t.forEach(function(a,u){a.setSide(f.side);var d=c+(o+i)*u,s=f.prominentCards.has(u)?-r/4:0,l=f.rot*Math.PI/180,p=d*Math.cos(l)-s*Math.sin(l),h=d*Math.sin(l)+s*Math.cos(l);a.animateTo({delay:e&&e.delay||0,duration:e&&e.duration||500,x:f.x+p,y:f.y+h,rot:f.rot,onComplete:function(){u===t.length-1&&n()}})}),m){var u=c+(o+i)*t.length-3*o/8+8*T.getFontSize(f.deck),s=f.rot*Math.PI/180,l=u*Math.cos(s),h=u*Math.sin(s);p.$el.classList.remove("alone"),p.$el.style[y]=d(f.x+l+"px",f.y+h+"px")+(f.rot?"rotate("+f.rot+"deg)":"")}}else m&&(p.$el.classList.add("alone"),p.$el.style[y]=d(f.x+"px",f.y+"px")+(f.rot?"rotate("+f.rot+"deg)":"")),n()},"HAND ("+f.id+") layout "+(n?": "+n:""))()}},f.setCardProminentAtIndex=function(n,e){e&&!f.prominentCards.has(n)?f.prominentCards.add(n):!e&&f.prominentCards.has(n)&&f.prominentCards.delete(n)},f.cardAtIndexIsProminent=function(n){return f.prominentCards.has(n)},f.clearProminentCards=function(){f.prominentCards.clear()},f.setCardSelectable=function(n,e){e?(n.setGlow(!0),n.$el.onclick=function(){if("function"==typeof f.onSelect){var e=f.cards.indexOf(n);f.onSelect(n,e)}}):(n.setGlow(!1),n.$el.onclick=null)},f.enableSelection=function(n){f.queued(function(e){f.selectionEnabled=n,f.cards.forEach(function(e){f.setCardSelectable(e,n)}),e()},"HAND ("+f.id+") enable selection ("+n+")")()},f.addCard=function(n){f.cards.push(n)},f.removeAllCards=function(){f.enableSelection(!1),f.cards=[],f.prominentCards=new Set},f.removeCardAtIndex=function(n){if(!(n>=f.cards.length)){var e=f.cards[n];f.selectionEnabled&&f.setCardSelectable(e,!1),f.cards.splice(n,1),f.prominentCards.has(n)&&f.prominentCards.delete(n);var t=new Set;for(var o in f.prominentCards.values())o.value<n?t.add(o.value):t.add(o.value-1);return f.prominentCards=t,e}},f.insertCardAtIndex=function(n,e){if(!(e<0)){if(e>f.cards.length)return void f.addCard(n,options);f.cards.splice(e,0,n);var t=new Set;for(var o in f.prominentCards.values())o.value<e?t.add(o.value):t.add(o.value+1);f.prominentCards=t}},f.replaceCardAtIndex=function(n,e){var t=f.cards[n];return f.selectionEnabled&&f.setCardSelectable(t,!1),f.selectionEnabled&&f.setCardSelectable(e,!0),f.cards[n]=e,t},f.layout(),f}function g(n,e,t){var o=t&&t.id||n.generateNextCliqueId(),r=f({id:o,deck:n,cards:e,queued:n.queued,beginQueueTransaction:n.beginQueueTransaction,endQueueTransaction:n.endQueueTransaction,withQueueTransaction:n.withQueueTransaction}),i=x.modules;for(var a in i)!function(n){n.deck&&n.deck(r)}(i[a]);return r.serialize=function(){return{id:r.id,cardIds:r.cards.map(function(n){return n.i})}},r.gatherCards=function(n){var e=[];n.forEach(function(n){var t=r.deck.cards.find(function(e){return n==e.i});void 0!==r.side&&t.setSide(r.side),e.push(t)}),r.cards=e},n.cliques[r.id]=r,r}function x(e){function t(){return(1679973079*m++%Math.pow(36,6)).toString(36)}function o(n){s.$root=n,s.$root.appendChild(d)}function r(){s.$root.removeChild(d)}function i(){var n={};for(var e in s.cliques)n[e]=s.cliques[e].serialize();return n}var a,c=new Array(e?55:52),u={},d=n("div"),s=f({mount:o,unmount:r,cards:c,cliques:u,$el:d,serialize:i,generateNextCliqueId:t}),l=x.modules;p(s);for(a in l)!function(n){n.deck&&n.deck(s)}(l[a]);d.classList.add("deck");for(var v,y=c.length;y;y--)v=c[y-1]=h(y-1),v.setSide("back"),v.mount(d);var m=1;return s}var C,$=[];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){setTimeout(n,0)});var b,S,k,I,q,w,E={linear:function(n){return n},quadIn:function(n){return n*n},quadOut:function(n){return n*(2-n)},quadInOut:function(n){return n<.5?2*n*n:(4-2*n)*n-1},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},quartIn:function(n){return n*n*n*n},quartOut:function(n){return 1- --n*n*n*n},quartInOut:function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},quintIn:function(n){return n*n*n*n*n},quintOut:function(n){return 1+--n*n*n*n*n},quintInOut:function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n}},T={fisherYates:o,getFontSize:r,getCardWidth:i,getCardHeight:a},A={deck:function(n){function e(e){var t=n.cards;b=T.getFontSize(n),t.forEach(function(n){n.bysuit(function(n){n===t.length-1&&e()})})}n.bysuit=n.queued(e)},card:function(n){var e=n.rank,t=n.suit;n.bysuit=function(o){var r=n.i,i=10*r;n.animateTo({delay:i,duration:400,x:-Math.round(8*(6.75-e)*b/16),y:-Math.round(92*(1.5-t)*b/16),rot:0,onComplete:function(){o(r)}})}}},z={deck:function(n){function e(e){var t=n.cards,o=t.length;S=T.getFontSize(n),t.forEach(function(n,r){n.fan(r,o,function(n){n===t.length-1&&e()})})}n.fan=n.queued(e)},card:function(n){var e=n.$el;n.fan=function(t,o,r){var i=t/4,a=10*t,u=t/(o-1)*260-130;n.animateTo({delay:a,duration:300,x:-i,y:-i,rot:0}),n.animateTo({delay:300+a,duration:300,x:55*Math.cos(c(u-90))*S/16,y:55*Math.sin(c(u-90))*S/16,rot:u,onStart:function(){e.style.zIndex=t},onComplete:function(){r(t)}})}}},M=document.createElement("p").style,L={},O={deck:function(n){function t(t){var o=n.cards;o.forEach(function(n,r){n.setSide("back"),n.intro(r,function(r){e(250,0).start(function(){n.setSide("back")}),r===o.length-1&&t()})})}n.intro=n.queued(t)},card:function(n){var e=u("transform"),t=n.$el;n.intro=function(o,r){var i=500+10*o,a=o/4;t.style[e]=d(-a+"px","-250px"),t.style.opacity=0,n.x=-a,n.y=-250-a,n.rot=0,n.animateTo({delay:i,duration:1e3,x:-a,y:-a,onStart:function(){t.style.zIndex=o},onProgress:function(n){t.style.opacity=n},onComplete:function(){t.style.opacity="",r&&r(o)}})}}},F={deck:function(n){function e(e){var t=n.cards,o=t.length;I=T.getFontSize(n),t.slice(-5).reverse().forEach(function(n,t){n.poker(t,o,function(t){n.setSide("front"),4===t&&e()})})}n.poker=n.queued(e)},card:function(n){var e=n.$el;n.poker=function(t,o,r){var i=250*t;n.animateTo({delay:i,duration:250,x:Math.round(70*(t-2.05)*I/16),y:Math.round(-110*I/16),rot:0,onStart:function(){e.style.zIndex=o-1+t},onComplete:function(){r(t)}})}}},P={deck:function(n){function e(e){q=T.getFontSize(n),n.cards=T.fisherYates(n.cards);var t=n.cards.slice();n.queued(function(n){t.forEach(function(e,o){e.pos=o,e.shuffle(function(e){e===t.length-1&&n()})})})()}n.shuffle=e},card:function(n){var e=n.$el;n.shuffle=function(t){var o=n.pos,r=o/4,i=2*o;n.animateTo({delay:i,duration:200,x:l(40*Math.random()+20)*q/16,y:-r,rot:0}),n.animateTo({delay:200+i,duration:200,x:-r,y:-r,rot:0,onStart:function(){e.style.zIndex=o},onComplete:function(){t(o)}})}}},N={deck:function(n){function e(e){w=T.getFontSize(n);var t=n.cards,o=e.order,r=Array(t.length);o.forEach(function(n,e){r[e]=t.find(function(e){return e.i==n})}),n.cards=r.slice(),n.queued(function(n){r.forEach(function(e,t){e.pos=t,e.shuffleTo(function(e){e===r.length-1&&n()})})})()}n.shuffleTo=e},card:function(n){var e=n.$el;n.shuffleTo=function(t){var o=n.pos,r=o/4,i=2*o;n.animateTo({delay:i,duration:200,x:l(40*Math.random()+20)*w/16,y:-r,rot:0}),n.animateTo({delay:200+i,duration:200,x:-r,y:-r,rot:0,onStart:function(){e.style.zIndex=o},onComplete:function(){t(o)}})}}},D={deck:function(n){function e(e,t){var o=n.cards;o.sort(function(n,e){return t?n.i-e.i:e.i-n.i}),o.forEach(function(n,r){n.sort(r,o.length,function(n){n===o.length-1&&e()},t)})}n.sort=n.queued(e)},card:function(n){var e=n.$el;n.sort=function(t,o,r,i){var a=t/4,c=10*t;n.animateTo({delay:c,duration:400,x:-a,y:-150,rot:0,onComplete:function(){e.style.zIndex=t}}),n.animateTo({delay:c+500,duration:400,x:-a,y:-a,rot:0,onComplete:function(){r(t)}})}}},H={deck:function(n){function e(e,t){var o=n.cards.filter(function(n){return"front"===n.side}).length/n.cards.length;n.cards.forEach(function(n,e){n.setSide(t||(o>.5?"back":"front"))}),e()}n.flip=n.queued(e)}};return h.Side=Object.freeze({FRONT:"front",BACK:"back"}),g.Pile=y,g.Hand=m,x.animationFrames=e,x.ease=E,x.modules={bysuit:A,fan:z,intro:O,poker:F,shuffle:P,shuffleTo:N,sort:D,flip:H},x.Card=h,x.prefix=u,x.translate=d,x.Util=T,x.Clique=g,x}();