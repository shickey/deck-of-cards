"use strict";var Deck=function(){function n(n,r){var o=Date.now(),e=o+n,u=e+r,i={start:e,end:u};x.push(i),g||(g=!0,requestAnimationFrame(t));var a={start:function(n){return i.startcb=n,a},progress:function(n){return i.progresscb=n,a},end:function(n){return i.endcb=n,a}};return a}function t(){var n=Date.now();if(!x.length)return void(g=!1);for(var r,o=0;o<x.length;o++)if(r=x[o],!(n<r.start)){r.started||(r.started=!0,r.startcb&&r.startcb());var e=(n-r.start)/(r.end-r.start);r.progresscb&&r.progresscb(e<1?e:1),n>r.end&&(r.endcb&&r.endcb(),x.splice(o--,1))}requestAnimationFrame(t)}function r(n){if(void 0!==I[n])return I[n];if(void 0!==$[n])return I[n]=n,n;for(var t,r=n[0].toUpperCase()+n.slice(1),o=["webkit","moz","Moz","ms","o"],e=0,u=o.length;e<u;e++)if(t=o[e]+r,void 0!==$[t])return I[n]=t,t}function o(n,t,r){return void 0!==k||(k=e()),r=r||0,k?"translate3d("+n+", "+t+", "+r+")":"translate("+n+", "+t+")"}function e(){if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return!1;var n=r("transform"),t=document.createElement("p");return document.body.appendChild(t),t.style[n]="translate3d(1px,1px,1px)",k=t.style[n],k=null!=k&&k.length&&"none"!==k,document.body.removeChild(t),k}function u(n){return document.createElement(n)}function i(t){function e(n){n.appendChild(p),g.$root=n}function i(){g.$root&&g.$root.removeChild(p),g.$root=null}function c(n){"front"===n?("back"===g.side&&p.removeChild(y),g.side="front",p.appendChild(v),g.setRankSuit(g.rank,g.suit)):("front"===g.side&&p.removeChild(v),g.side="back",p.appendChild(y),p.setAttribute("class","card"))}var f,d=r("transform"),s=t%13+1,l=t/13|0,h=(52-t)/4,p=u("div"),v=u("div"),y=u("div"),g={i:t,rank:s,suit:l,pos:t,$el:p,mount:e,unmount:i,setSide:c},x=m.modules;v.classList.add("face"),y.classList.add("back"),p.style[d]=o(-h+"px",-h+"px"),g.x=-h,g.y=-h,g.z=h,g.rot=0,g.setSide("back");for(f in x)!function(n){n.card&&n.card(g)}(x[f]);return g.animateTo=function(t){var r=t.delay,e=t.duration,u=t.x,i=void 0===u?g.x:u,a=t.y,c=void 0===a?g.y:a,f=t.rot,s=void 0===f?g.rot:f,l=t.ease,h=t.onStart,v=t.onProgress,y=t.onComplete;r=r||0,e=e||500;var m,x,k,b,q,C;n(r,e).start(function(){m=g.x||0,x=g.y||0,k=g.rot||0,h&&h()}).progress(function(n){var t=M[l||"cubicInOut"](n);b=i-m,q=c-x,C=s-k,v&&v(n,t),g.x=m+b*t,g.y=x+q*t,g.rot=k+C*t,p.style[d]=o(g.x+"px",g.y+"px")+(g.rot?"rotate("+g.rot+"deg)":"")}).end(function(){y&&y()})},g.setRankSuit=function(n,t){var r=a(t);p.setAttribute("class","card "+r+" rank"+n)},g.setRankSuit(s,l),g}function a(n){return 0===n?"spades":1===n?"hearts":2===n?"clubs":3===n?"diamonds":"joker"}function c(n){return(Math.round(Math.random())?-1:1)*n}function f(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}function d(n){for(var t,r,o=n.length-1;o;o--)t=Math.floor(Math.random()*(o+1)),r=n[o],n[o]=n[t],n[t]=r;return n}function s(n){return n*Math.PI/180}function l(n,t,r){function o(n){return function(){var t=i.cards.pop();t.$el.classList.remove("glow"),t.$el.onclick=null,i.canDraw=!1,n&&n(t)}}var e=r.x,u=r.y;e=e||0,u=u||0;var i=Object.assign(v(n,t),{x:e,y:u,canDraw:!1});return t.forEach(function(n){n.$el.onclick=null}),i.setup=function(n){i.queued(function(n){i.cards.forEach(function(t,r){var o=r/4;t.setSide("back"),t.$el.style.zIndex=r,t.animateTo({delay:0,duration:200,x:i.x-o,y:i.y-o,rot:0,onComplete:function(){r===i.cards.length-1&&n()}})})})()},i.draw=function(n){if(void 0===n&&(n=1),1==n)return i.cards.pop();for(var t=[],r=0;r<n;++r)t.push(i.cards.pop());return t},i.prepareForDraw=function(n){i.queued(function(t){if(n){i.canDraw=!0;var r=i.cards[i.cards.length-1];r.$el.classList.add("glow"),r.$el.onclick=o(n)}else{i.canDraw=!1;var r=i.cards[i.cards.length-1];r.$el.classList.remove("glow"),r.$el.onclick=null}t()})()},i.setup(),i}function h(n,t,r){var o=r.x,e=r.y,u=r.rot;o=o||0,e=e||0,u=u||0;var i=Object.assign(v(n,t),{x:o,y:e,rot:u});return i.cards.forEach(function(n){n.$el.onclick=null}),i.layout=function(){if(0!==i.cards.length){var n=i.cards.slice(),t=3.875*f(),r=t/10;i.queued(function(o){var e=t*(n.length-1)+r*(n.length-1),u=-e/2;n.forEach(function(e,a){var c=u+(t+r)*a,f=i.rot*Math.PI/180,d=c*Math.cos(f),s=c*Math.sin(f);e.animateTo({duration:200,x:i.x+d,y:i.y+s,rot:i.rot,onComplete:function(){a===n.length-1&&o()}})})})()}},i.addCard=function(n){i.cards.push(n),i.layout()},i.layout(),i}function p(n){function t(n,t,r){u[n]||(u[n]=[]),u[n].push({cb:t,ctx:r})}function r(n,t,r){u[n]||(u[n]=[]),u[n].push({cb:t,ctx:r,once:!0})}function o(n){var t=this,r=Array.prototype.slice(arguments,1);(u[n]||[]).filter(function(n){return n.cb.apply(t,r),!n.once})}function e(n,t){return n?t?void(u[n]=u[n].filter(function(n){return n.cb!==t})):void(u[n]=[]):void(u={})}n||(n={});var u={};return n.on=t,n.one=r,n.off=e,n.trigger=o,n}function v(n,t){var r=p({deck:n,cards:t,queued:n.queued}),o=m.modules;for(var e in o)!function(n){n.deck&&n.deck(r)}(o[e]);return r}function y(n){function t(n){return function(){var t=this,o=arguments;r(function(r){n.apply(t,e.concat.apply(r,o))})}}function r(n){n&&(u.push(n),1===u.length&&o())}function o(){u[0](function(n){if(n)throw n;u=u.slice(1),u.length&&o()})}var e=Array.prototype,u=[];return n.queue=r,n.queued=t,n}function m(n){function t(n){o=n,o.appendChild(c)}function r(){o.removeChild(c)}var o,e,a=new Array(n?55:52),c=u("div"),f=p({mount:t,unmount:r,cards:a,$el:c}),d=m.modules;y(f);for(e in d)!function(n){n.deck&&n.deck(f)}(d[e]);c.classList.add("deck");for(var s,l=a.length;l;l--)s=a[l-1]=i(l-1),s.setSide("back"),s.mount(c);return f}var g,x=[];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){setTimeout(n,0)});var k,b,q,C,w,$=document.createElement("p").style,I={},M={linear:function(n){return n},quadIn:function(n){return n*n},quadOut:function(n){return n*(2-n)},quadInOut:function(n){return n<.5?2*n*n:(4-2*n)*n-1},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},quartIn:function(n){return n*n*n*n},quartOut:function(n){return 1- --n*n*n*n},quartInOut:function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},quintIn:function(n){return n*n*n*n*n},quintOut:function(n){return 1+--n*n*n*n*n},quintInOut:function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n}},S={deck:function(n){function t(t,r){var o=n.cards.filter(function(n){return"front"===n.side}).length/n.cards.length;n.cards.forEach(function(n,t){n.setSide(r||(o>.5?"back":"front"))}),t()}n.flip=n.queued(t)}},T={deck:function(n){function t(t,r){var o=n.cards;o.sort(function(n,t){return r?n.i-t.i:t.i-n.i}),o.forEach(function(n,e){n.sort(e,o.length,function(n){n===o.length-1&&t()},r)})}n.sort=n.queued(t)},card:function(n){var t=n.$el;n.sort=function(r,o,e,u){var i=r/4,a=10*r;n.animateTo({delay:a,duration:400,x:-i,y:-150,rot:0,onComplete:function(){t.style.zIndex=r}}),n.animateTo({delay:a+500,duration:400,x:-i,y:-i,rot:0,onComplete:function(){e(r)}})}}},E={deck:function(n){function t(t){var r=n.cards,o=t.order,e=Array(r.length);o.forEach(function(n,t){e[t]=r.find(function(t){return t.i==n})}),n.cards=e.slice(),n.queued(function(n){e.forEach(function(t,r){t.pos=r,t.shuffleTo(function(t){t===e.length-1&&n()})})})()}n.shuffleTo=t},card:function(n){var t=n.$el,r=f();n.shuffleTo=function(o){var e=n.pos,u=e/4,i=2*e;n.animateTo({delay:i,duration:200,x:c(40*Math.random()+20)*r/16,y:-u,rot:0}),n.animateTo({delay:200+i,duration:200,x:-u,y:-u,rot:0,onStart:function(){t.style.zIndex=e},onComplete:function(){o(e)}})}}},O={deck:function(n){function t(t){var r=n.cards;b=f(),d(r),r.forEach(function(n,o){n.pos=o,n.shuffle(function(n){n===r.length-1&&t()})})}n.shuffle=n.queued(t)},card:function(n){var t=n.$el;n.shuffle=function(r){var o=n.pos,e=o/4,u=2*o;n.animateTo({delay:u,duration:200,x:c(40*Math.random()+20)*b/16,y:-e,rot:0}),n.animateTo({delay:200+u,duration:200,x:-e,y:-e,rot:0,onStart:function(){t.style.zIndex=o},onComplete:function(){r(o)}})}}},A={deck:function(n){function t(t){var r=n.cards,o=r.length;q=f(),r.slice(-5).reverse().forEach(function(n,r){n.poker(r,o,function(r){n.setSide("front"),4===r&&t()})})}n.poker=n.queued(t)},card:function(n){var t=n.$el;n.poker=function(r,o,e){var u=250*r;n.animateTo({delay:u,duration:250,x:Math.round(70*(r-2.05)*q/16),y:Math.round(-110*q/16),rot:0,onStart:function(){t.style.zIndex=o-1+r},onComplete:function(){e(r)}})}}},z={deck:function(t){function r(r){var o=t.cards;o.forEach(function(t,e){t.setSide("back"),t.intro(e,function(e){n(250,0).start(function(){t.setSide("back")}),e===o.length-1&&r()})})}t.intro=t.queued(r)},card:function(n){var t=r("transform"),e=n.$el;n.intro=function(r,u){var i=500+10*r,a=r/4;e.style[t]=o(-a+"px","-250px"),e.style.opacity=0,n.x=-a,n.y=-250-a,n.rot=0,n.animateTo({delay:i,duration:1e3,x:-a,y:-a,onStart:function(){e.style.zIndex=r},onProgress:function(n){e.style.opacity=n},onComplete:function(){e.style.opacity="",u&&u(r)}})}}},P={deck:function(n){function t(t){var r=n.cards,o=r.length;C=f(),r.forEach(function(n,e){n.fan(e,o,function(n){n===r.length-1&&t()})})}n.fan=n.queued(t)},card:function(n){var t=n.$el;n.fan=function(r,o,e){var u=r/4,i=10*r,a=r/(o-1)*260-130;n.animateTo({delay:i,duration:300,x:-u,y:-u,rot:0}),n.animateTo({delay:300+i,duration:300,x:55*Math.cos(s(a-90))*C/16,y:55*Math.sin(s(a-90))*C/16,rot:a,onStart:function(){t.style.zIndex=r},onComplete:function(){e(r)}})}}},D={deck:function(n){function t(t){var r=n.cards;w=f(),r.forEach(function(n){n.bysuit(function(n){n===r.length-1&&t()})})}n.bysuit=n.queued(t)},card:function(n){var t=n.rank,r=n.suit;n.bysuit=function(o){var e=n.i,u=10*e;n.animateTo({delay:u,duration:400,x:-Math.round(8*(6.75-t)*w/16),y:-Math.round(92*(1.5-r)*w/16),rot:0,onComplete:function(){o(e)}})}}};return v.Pile=l,v.Hand=h,m.animationFrames=n,m.ease=M,m.modules={bysuit:D,fan:P,intro:z,poker:A,shuffle:O,shuffleTo:E,sort:T,flip:S},m.Card=i,m.prefix=r,m.translate=o,m.util={fisherYates:d},m.Clique=v,m}();